
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>stix2arango 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="welcome-to-stix2arango-s-documentation">
<h1>Welcome to stix2arango’s documentation!<a class="headerlink" href="#welcome-to-stix2arango-s-documentation" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="stix2arango.feed.Feed">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">stix2arango.feed.</span></span><span class="sig-name descname"><span class="pre">Feed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_paradigm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vaccum_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.feed.Feed" title="Permalink to this definition">¶</a></dt>
<dd><p>A Feed is a container for a set of STIX objects.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stix2arango.feed.Feed.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_paradigm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vaccum_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.feed.Feed.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a Feed object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_conn</strong> (<em>pyarango database object</em>) – the database connection</p></li>
<li><p><strong>feed_name</strong> (<em>str</em>) – the name of the feed</p></li>
<li><p><strong>tags</strong> (<em>list</em><em>, </em><em>optional</em>) – the tags that the feed will carry. Defaults to [].</p></li>
<li><p><strong>date</strong> (<em>datetime</em><em>, </em><em>optional</em>) – date of the next insertion. Defaults to now.</p></li>
<li><p><strong>storage_paradigm</strong> (<em>int</em><em>, </em><em>optional</em>) – explain to stix2arango how to store/request objects depending on time. Defaults to TIME_BASED.</p></li>
<li><p><strong>vaccum_date</strong> (<em>datetime</em><em>, </em><em>optional</em>) – date of the feed deletion. If no value is provided, vaccum_date is calculated to date + 60 days. If set to 0, the feed will not be deleted. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stix2arango.feed.Feed.get_last_feeds">
<span class="sig-name descname"><span class="pre">get_last_feeds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_before</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.feed.Feed.get_last_feeds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the last feeds before a certain date.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_conn</strong> (<em>pyarango database</em>) – the database connection</p></li>
<li><p><strong>d_before</strong> (<em>datetime</em>) – the date before which we want the feeds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of feeds</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stix2arango.feed.Feed.insert_stix_object_in_arango">
<span class="sig-name descname"><span class="pre">insert_stix_object_in_arango</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l_object</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.feed.Feed.insert_stix_object_in_arango" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a list of stix objects in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>l_object</strong> (<em>list</em>) – the list of stix objects to insert</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
<div class="line">Storage paradigm (Cf storage_paradigm in stix2arango.feed.Feed):</div>
</div>
<span class="target" id="module-stix2arango.storage"></span><dl class="py data">
<dt class="sig sig-object py" id="stix2arango.storage.GROUPED">
<span class="sig-prename descclassname"><span class="pre">stix2arango.storage.</span></span><span class="sig-name descname"><span class="pre">GROUPED</span></span><em class="property"><span class="w">  </span><span class="p"><span class="pre">=</span></span><span class="w">  </span><span class="pre">2</span></em><a class="headerlink" href="#stix2arango.storage.GROUPED" title="Permalink to this definition">¶</a></dt>
<dd><p>every data inserted goes to the same collection</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="stix2arango.storage.GROUPED_BY_DAY">
<span class="sig-prename descclassname"><span class="pre">stix2arango.storage.</span></span><span class="sig-name descname"><span class="pre">GROUPED_BY_DAY</span></span><em class="property"><span class="w">  </span><span class="p"><span class="pre">=</span></span><span class="w">  </span><span class="pre">4</span></em><a class="headerlink" href="#stix2arango.storage.GROUPED_BY_DAY" title="Permalink to this definition">¶</a></dt>
<dd><p>every data inserted in a day goes in the same collection</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="stix2arango.storage.GROUPED_BY_MONTH">
<span class="sig-prename descclassname"><span class="pre">stix2arango.storage.</span></span><span class="sig-name descname"><span class="pre">GROUPED_BY_MONTH</span></span><em class="property"><span class="w">  </span><span class="p"><span class="pre">=</span></span><span class="w">  </span><span class="pre">3</span></em><a class="headerlink" href="#stix2arango.storage.GROUPED_BY_MONTH" title="Permalink to this definition">¶</a></dt>
<dd><p>every data inserted in a month goes in the same collection</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="stix2arango.storage.TIME_BASED">
<span class="sig-prename descclassname"><span class="pre">stix2arango.storage.</span></span><span class="sig-name descname"><span class="pre">TIME_BASED</span></span><em class="property"><span class="w">  </span><span class="p"><span class="pre">=</span></span><span class="w">  </span><span class="pre">1</span></em><a class="headerlink" href="#stix2arango.storage.TIME_BASED" title="Permalink to this definition">¶</a></dt>
<dd><p>every insertion, a new collection is created</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stix2arango.storage.get_collection_name">
<span class="sig-prename descclassname"><span class="pre">stix2arango.storage.</span></span><span class="sig-name descname"><span class="pre">get_collection_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.storage.get_collection_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the name of the collection to use for the given feed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>feed</strong> (<a class="reference internal" href="#stix2arango.feed.Feed" title="stix2arango.feed.Feed"><em>stix2arango.feed.Feed</em></a>) – The feed to use.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#stix2arango.exceptions.UnknownStorageParadigm" title="stix2arango.exceptions.UnknownStorageParadigm"><strong>UnknownStorageParadigm</strong></a> – If the feed’s storage paradigm is unknown.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The name of the collection to use.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="stix2arango.request.Request">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">stix2arango.request.</span></span><span class="sig-name descname"><span class="pre">Request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.request.Request" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to manage a request to the database</p>
<dl class="py method">
<dt class="sig sig-object py" id="stix2arango.request.Request.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.request.Request.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the request</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_conn</strong> (<em>pyArango database</em>) – the database connection</p></li>
<li><p><strong>date</strong> (<em>datetime</em>) – the date before which the objects must be requested</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stix2arango.request.Request.request">
<span class="sig-name descname"><span class="pre">request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.request.Request.request" title="Permalink to this definition">¶</a></dt>
<dd><p>Request the objects from the database</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pattern</strong> (<em>str</em>) – the stix2.1 pattern</p></li>
<li><p><strong>tags</strong> (<em>list</em><em>, </em><em>optional</em>) – Request the feed tag with all the provided tags. Defaults to [].</p></li>
<li><p><strong>max_depth</strong> (<em>int</em><em>, </em><em>optional</em>) – graph traversal depth limit. Defaults to 5.</p></li>
<li><p><strong>create_index</strong> (<em>bool</em><em>, </em><em>optional</em>) – create an index based on search to optimize future query. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the objects which match the pattern and their related objects (depth limited)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stix2arango.request.Request.request_one_feed">
<span class="sig-name descname"><span class="pre">request_one_feed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.request.Request.request_one_feed" title="Permalink to this definition">¶</a></dt>
<dd><p>Request the objects from a feed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feed</strong> (<a class="reference internal" href="#stix2arango.feed.Feed" title="stix2arango.feed.Feed"><em>stix2arango.feed.Feed</em></a>) – the feed to request</p></li>
<li><p><strong>pattern</strong> (<em>str</em>) – the stix2.1 pattern</p></li>
<li><p><strong>max_depth</strong> (<em>int</em><em>, </em><em>optional</em>) – graph traversal depth limit. Defaults to 5.</p></li>
<li><p><strong>create_index</strong> (<em>bool</em><em>, </em><em>optional</em>) – create an index based on search to optimize future query. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the objects which match the pattern and their related objects (depth limited)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<span class="target" id="module-stix2arango.exceptions"></span><dl class="py exception">
<dt class="sig sig-object py" id="stix2arango.exceptions.FieldCanNotBeCalculatedBy">
<em class="property"><span class="pre">exception</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">stix2arango.exceptions.</span></span><span class="sig-name descname"><span class="pre">FieldCanNotBeCalculatedBy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stix_modifiers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.exceptions.FieldCanNotBeCalculatedBy" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised when a field can not be calculated by a stixmodifier</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="stix2arango.exceptions.MalformatedComparaison">
<em class="property"><span class="pre">exception</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">stix2arango.exceptions.</span></span><span class="sig-name descname"><span class="pre">MalformatedComparaison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compare_string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.exceptions.MalformatedComparaison" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised when patterning is not correct</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="stix2arango.exceptions.MalformatedExpression">
<em class="property"><span class="pre">exception</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">stix2arango.exceptions.</span></span><span class="sig-name descname"><span class="pre">MalformatedExpression</span></span><a class="headerlink" href="#stix2arango.exceptions.MalformatedExpression" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised when patterning is not correct</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="stix2arango.exceptions.PatternAlreadyContainsType">
<em class="property"><span class="pre">exception</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">stix2arango.exceptions.</span></span><span class="sig-name descname"><span class="pre">PatternAlreadyContainsType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.exceptions.PatternAlreadyContainsType" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised when a pattern request two types of cyber obervables
ex [<a class="reference external" href="file:hash:md5">file:hash:md5</a> = ‘…’ AND ipv4-addr:value=’8.8.8.8’]</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="stix2arango.exceptions.UnknownStorageParadigm">
<em class="property"><span class="pre">exception</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">stix2arango.exceptions.</span></span><span class="sig-name descname"><span class="pre">UnknownStorageParadigm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stix2arango.exceptions.UnknownStorageParadigm" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised when the storage paradigm is unknown.</p>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">stix2arango</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, theophane-droid.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>